#template /templates/main.html

<head>
    @use (~/assets/js/shader.js[defer], ./index.css);

    @page {
        title: "LSTV | Home";
        description: "Welcome to the home of LSTV.space.";
        keywords: "LSTV, home, projects, services, community";
    }
</head>

<div .content>
    <div .full-height .logo-board>
        <div #logo>
            <img src="/assets/image/prism_light.png" fetchpriority="high" srcset="/assets/image/prism_light.png 1x, /assets/image/prism_light_2x.png 2x" alt="LSTV Triangle Logo" draggable="false">
        
            <div .stripe-container>
                <div style="--c: 237, 108, 48; --d: 0.4s" />
                <div style="--c: 252, 194, 27; --d: 0.2s" />
                <div style="--c: 64, 192, 231; --d: 0s" />
            </div>
        </div>
    
        <span .logo_text>LSTV</span>
    
        <canvas #raysBga style="object-position: bottom center; z-index: -1" .bga />
        <div #chevron .visible .mono .level-top><i class="bi-chevron-down"></i> Scroll down <i class="bi-chevron-down"></i></div>
    </div>
    
    <div .level-0>
        <div .marqueeBar .mono .level-3>
            <div>
                <span>Welcome to LSTV.space</span>
                <span>Welcome to LSTV.space</span>
                <span>Welcome to LSTV.space</span>
                <span>Welcome to LSTV.space</span>
            </div>
        </div>
    
        <div .padding>
            <canvas #glCanvas .bga />
    
            <div .guy-lore .mono .padding>
                <div style="z-index: 5">
    
                    <h1>Who am I?</h1>
    
                    <ls-div .margin-bottom-xxlarge>
                        <ls-div>
                            My name is <b>{{ about.name }} / {{ about.name_alt }}</b>.<br>
                            I am an {{ about.age }} years old student in IT, with about {{ about.coding_years }} years of coding experience, {{ about.design_years }} years of design experience, and ~{{ about.music_years }} year of sound design experience, all self-taught. (More information on my <a href="https://github.com/the-lstv">Github profile</a>).
                        </ls-div>
    
                        <ls-div>
                            I design and develop software, attempt making music, and develop games. I do all kinds of things from networking, hardware, libraries and utility to creative software. I also enjoy video editing, sound composition and design, writing, animating, you name it.<br>
                            My current main area of expertise is software optimization, design, graphics/rendering software, and networking software. I'm a bit of a perfectionist.
                        </ls-div>
                    </ls-div>
    
                    <ls-div>
                        <ls-div>
                            <h1>What's "LSTV"?</h1>
                            LSTV is a broad term describing our community of developers, artists, and producers (or just people who enjoy what we make), aiming to provide an open, universal environment to create awesome high-quality projects.<br>
                            But it can also mean the services and products we offer.<br>
                            <b>Note:</b> LSTV is not my nickname. To refer to me, please use my name (Lukas) or one of my aliases.
                        </ls-div>
    
                        <ls-div .margin-top-xxxlarge>
                            <div style="text-align: center">
                                <a href="https://discord.gg/jQm9yGKCEC" target="_blank" .ls-button .pill style="padding: 12px 45px; display: inline-flex; align-items: center">
                                    <i .bi-discord style="font-size: xx-large; margin-right: 20px"></i>
                                    Join our Discord server!
                                </a>
                            </div>
                        </ls-div>
                    </ls-div>
    
                </div>
            </div>
        </div>
    
        <div .marqueeBar .mono .level-3>
            <div>
                <span>Welcome to LSTV.space</span>
                <span>Welcome to LSTV.space</span>
                <span>Welcome to LSTV.space</span>
                <span>Welcome to LSTV.space</span>
            </div>
        </div>
    </div>
    
    <div #footer .level-1>

        <svg style="width: 300px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 290 95" fill="none"><path d="M101.84 73V20.44h10.8v42.48h21.24V73h-32.04zm65.132.72c-3.696 0-6.912-.624-9.648-1.872s-4.848-3-6.336-5.256-2.232-4.92-2.232-7.992h10.8c0 1.776.672 3.192 2.016 4.248 1.392 1.008 3.264 1.512 5.616 1.512 2.256 0 4.008-.504 5.256-1.512 1.296-1.008 1.944-2.4 1.944-4.176 0-1.536-.48-2.856-1.44-3.96s-2.304-1.848-4.032-2.232l-5.328-1.224c-4.464-1.056-7.944-3-10.44-5.832-2.448-2.88-3.672-6.384-3.672-10.512 0-3.072.696-5.736 2.088-7.992 1.44-2.304 3.456-4.08 6.048-5.328s5.664-1.872 9.216-1.872c5.376 0 9.624 1.344 12.744 4.032 3.168 2.64 4.752 6.216 4.752 10.728h-10.8c0-1.68-.6-3-1.8-3.96-1.152-.96-2.832-1.44-5.04-1.44-2.064 0-3.648.48-4.752 1.44-1.104.912-1.656 2.232-1.656 3.96 0 1.536.432 2.856 1.296 3.96.912 1.056 2.184 1.776 3.816 2.16l5.616 1.296c4.656 1.056 8.184 2.976 10.584 5.76 2.4 2.736 3.6 6.24 3.6 10.512 0 3.072-.768 5.784-2.304 8.136-1.488 2.352-3.6 4.176-6.336 5.472-2.688 1.296-5.88 1.944-9.576 1.944zm44.972-.72V30.52h-13.32V20.44h37.44v10.08h-13.32V73h-10.8zm49.004 0l-13.032-52.56h11.16l7.272 33.192.864 4.392c.384 1.776.672 3.288.864 4.536l.72-4.536.792-4.464 7.056-33.12h10.872L274.628 73h-13.68z" fill="url(#TC)"/><path d="M40.321 20H78v14H48.348l-8.027-14z" fill="#ed6c30"/><path d="M51.215 39H78v15H59.816l-8.601-15z" fill="#fcc21b"/><path d="M62.683 59H78v14h-7.29l-8.027-14z" fill="#40c0e7"/><path d="M12.483 68L35 29l22.517 39H12.483z" stroke="var(--color)" stroke-width="9"/><defs><linearGradient id="TC" x1="95" y1="-48.5" x2="279.5" y2="63.5" gradientUnits="userSpaceOnUse"><stop stop-color="#fcc21b"/><stop offset=".465" stop-color="#fcc21b"/><stop offset=".465" stop-color="#ed6c30"/><stop offset=".725" stop-color="#ed6c30"/><stop offset=".725" stop-color="#40c0e7"/></linearGradient></defs></svg>

        <div ls-accent="auto" style="line-height: 1.6em; text-align: center">
            <a href="/tos">Terms of Service</a> · <a href="/pp">Privacy Policy</a> <br>
            <a style="font-weight: 100" href="https://github.com/the-lstv/lstv-web"><i class="bi-github"></i> Website GitHub</a>
        </div>

    </div>
</div>

<!--

--- ROADMAP

- [ ] Projects showcase
- [ ] Music showcase
- [ ] Store page
- [ ] App integration
- [ ] Chat platform
- [ ] Blog
- [ ] Better introduction
- [ ] Sitewide navigation
- [ ] Bring back SPA design
- [ ] Reason of insanity

-->

<script>
const year = new Date().getFullYear();

const about = LS.Reactive.wrap("about", {
    coding_years: year - 2016,
    design_years: year - 2021,
    music_years: year - 2024,
    age: year - 2007,
    name: "Lukáš",
    name_alt: "Lukas",
    location: "Czech Republic",
    github: "https://github.com/the-lstv"
});

app.module(document.currentScript, (app, page, container) => {
    let bgaSpeedFactor = .001, cloudsCanvas = O("#glCanvas"), raysCanvas = O("#raysBga"), cloudsRenderer, blurRenderer, noiseRenderer;
    page.requiresReload = true;

    function customSort(arr) {
        // Create a map for quick lookup of customOrder positions
        const customOrderMap = new Map(customOrder.map((id, index) => [id, index]));
        
        // Sort function
        arr.sort((a, b) => {
            // First, handle customBackOrder by placing those IDs at the end
            const aInBackOrder = customBackOrder.indexOf(a.id) !== -1;
            const bInBackOrder = customBackOrder.indexOf(b.id) !== -1;
            
            if (aInBackOrder && !bInBackOrder) return 1;
            if (!aInBackOrder && bInBackOrder) return -1;
            if (aInBackOrder && bInBackOrder) return customBackOrder.indexOf(a.id) - customBackOrder.indexOf(b.id);
            
            // Then, handle customOrder
            const aOrder = customOrderMap.has(a.id) ? customOrderMap.get(a.id) : customOrder.length;
            const bOrder = customOrderMap.has(b.id) ? customOrderMap.get(b.id) : customOrder.length;
            
            if (aOrder !== bOrder) return aOrder - bOrder;
            
            // Finally, handle customGroups
            for (let group of customGroups) {
                const aInGroup = group.findIndex(item => item === a.id);
                const bInGroup = group.findIndex(item => item === b.id);
                
                if (aInGroup !== -1 && bInGroup !== -1) {
                    return aInGroup - bInGroup;
                }
                if (aInGroup !== -1) return -1;
                if (bInGroup !== -1) return 1;
            }
            
            // Fallback to natural order by ID if none of the above applied
            return a.id - b.id;
        });
    }

    const contentContainer = container.get(".content");

    setTimeout(() => {
        let lastScroll = 0, initialLoadApps = false;

        const onScroll = () => {
            let scroll = container.scrollTop;
    
            window.requestAnimationFrame(() => {
                contentContainer.style.maxWidth = Math.min(1360 + scroll, 1920) + "px"
                // svgElement.style.transform = `translateY(${(scroll - 1000) / 2}px) scale(${(scroll + 1000) / 2000}) rotate(${(scroll - 2500) / 100}deg)`;
            })
    
            if (Math.abs(scroll - lastScroll) > 10) {
                container.get("#chevron").class("visible", scroll < 60)
    
                if(!initialLoadApps && scroll > 600) {
                    initialLoadApps = true
                    // loadApps()
                }

                if(cloudsCanvas.isInView()){
                    cloudsRenderer.resume();
                } else cloudsRenderer.paused = true;
    
                if(raysCanvas.isInView()){
                    blurRenderer.resume();
                } else blurRenderer.paused = true;

                lastScroll = scroll;
            }
        }

        cloudsRenderer = new CombinedShaderRenderer(cloudsCanvas);

        cloudsRenderer.addShaderContext(ShaderSource.clouds(cloudsRenderer.gl), {
            u_time: { type: "uniform1f", value: time => [time * bgaSpeedFactor] },
            u_resolution: { type: "uniform2f", value: () => [cloudsCanvas.width, cloudsCanvas.height] },
            u_speed: { type: "uniform1f", value: [0.196] },
            u_scale: { type: "uniform1f", value: [0] },
            u_colors: { type: "uniform4fv", value: [[1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0]] },
            light: { type: "uniform1f", value: [0.5] },
            shadow: { type: "uniform1f", value: [0.5] },
            tint: { type: "uniform1f", value: [0.5] },
            coverage: { type: "uniform1f", value: [0.3] },
            alpha: { type: "uniform1f", value: [1.0] },
        })

        blurRenderer = new CombinedShaderRenderer(raysCanvas);

        blurRenderer.addShaderContext(ShaderSource.blurredColors(blurRenderer.gl), {
            u_time: { type: "uniform1f", value: time => [(time * bgaSpeedFactor) + 1000] },
            u_resolution: { type: "uniform2f", value: () => [cloudsCanvas.width, cloudsCanvas.height] },
            u_speed: { type: "uniform1f", value: [0.196] },
            u_scale: { type: "uniform1f", value: [4] },
            u_colors: { type: "uniform4fv", value: [[0.25098039215686274,0.7529411764705882,0.9058823529411765,1,0.9882352941176471,0.7607843137254902,0.10588235294117647,1,0.9294117647058824,0.4235294117647059,0.18823529411764706,1,0,0,0,0]] },
            u_blur: { type: "uniform1f", value: [1] },
            u_animate: { type: "uniform1f", value: [1] },
            u_animate_speed: { type: "uniform1f", value: [1] },
            u_frequency: { type: "uniform1f", value: [0] },
            alpha: { type: "uniform1f", value: [1] },
        })

        blurRenderer.resume();

        onScroll();
        container.classList.add("vfx-loaded");

        container.addEventListener("scroll", onScroll);
    }, 50);
});
</script>